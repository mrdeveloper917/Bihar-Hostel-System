<% title = "Pay Fees" %>

<section class="container my-5">
  <!-- Header -->
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-5">
    <div>
      <h2 class="fw-bold mb-1 text-gradient">
        ðŸ’³ Pay Your Hostel Fees
      </h2>
      <p class="text-muted fs-6 mb-0">
        Complete your payment securely through UPI, Card, or QR options.
      </p>
    </div>
    <div class="date-badge mt-3 mt-md-0">
      <i class="bi bi-calendar3 me-1"></i>
      Today: <%= (new Date()).toLocaleDateString() %>
    </div>
  </div>

  <!-- Payment Section -->
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="card shadow-sm border-0 glass-effect p-4">
        <div class="mb-4 text-center">
          <i class="bi bi-credit-card fs-2 text-primary mb-3"></i>
          <h4 class="fw-semibold mb-1">Fee Amount: â‚¹<%= student.totalFeesDue || 5000 %></h4>
          <p class="text-muted mb-0">Student: <strong><%= user.name %></strong></p>
          <p class="text-muted small"><%= user.email %></p>
        </div>

        <hr />

        <form id="paymentForm" method="POST" action="/student/pay/confirm">
          <!-- Payment Mode -->
          <div class="mb-3">
            <label class="form-label fw-semibold">Select Payment Mode</label>
            <select class="form-select" name="method" required>
              <option value="">-- Choose Method --</option>
              <option value="UPI">UPI / Wallet</option>
              <option value="Card">Debit / Credit Card</option>
              <option value="QR">Scan & Pay (QR Code)</option>
            </select>
          </div>

          <!-- UPI Section -->
          <div id="upiSection" class="payment-option d-none">
            <label class="form-label fw-semibold">Enter UPI ID</label>
            <input type="text" name="upi" class="form-control mb-3" placeholder="e.g. ayush@upi" />
          </div>

          <!-- Card Section -->
          <div id="cardSection" class="payment-option d-none">
            <label class="form-label fw-semibold">Card Number</label>
            <input type="text" name="cardNumber" class="form-control mb-2" placeholder="XXXX XXXX XXXX XXXX" />
            <div class="row">
              <div class="col-md-6 mb-2">
                <input type="text" name="expiry" class="form-control" placeholder="MM/YY" />
              </div>
              <div class="col-md-6 mb-2">
                <input type="text" name="cvv" class="form-control" placeholder="CVV" />
              </div>
            </div>
          </div>

          <!-- QR Section -->
          <div id="qrSection" class="payment-option d-none text-center">
            <p class="text-muted small mb-2">Scan this QR using any UPI app</p>
            <img src="/img/qr-placeholder.png" alt="QR Code" class="img-fluid rounded shadow-sm" width="180" />
          </div>

          <div class="text-center mt-4">
            <button type="submit" class="btn btn-primary px-4 rounded-pill">
              <i class="bi bi-lock-fill me-2"></i> Pay Securely
            </button>
          </div>
        </form>
      </div>

      <!-- Success Message -->
      <div id="successMessage" class="card glass-effect shadow-sm mt-4 text-center p-4 d-none">
        <i class="bi bi-check-circle-fill text-success fs-2 mb-3"></i>
        <h5 class="fw-bold">Payment Successful!</h5>
        <p class="text-muted mb-3">
          Your payment of â‚¹<%= student.totalFeesDue || 5000 %> was received successfully.
        </p>
        <a href="/student" class="btn btn-outline-success rounded-pill">Back to Dashboard</a>
      </div>
    </div>
  </div>
</section>

<!-- JS -->
<script>
  // Toggle between payment methods
  const methodSelect = document.querySelector('select[name="method"]');
  const options = document.querySelectorAll(".payment-option");
  const form = document.getElementById("paymentForm");
  const successMessage = document.getElementById("successMessage");

  methodSelect.addEventListener("change", () => {
    options.forEach(opt => opt.classList.add("d-none"));
    if (methodSelect.value === "UPI") document.getElementById("upiSection").classList.remove("d-none");
    if (methodSelect.value === "Card") document.getElementById("cardSection").classList.remove("d-none");
    if (methodSelect.value === "QR") document.getElementById("qrSection").classList.remove("d-none");
  });

  // Fake payment simulation
  form.addEventListener("submit", (e) => {
    e.preventDefault();
    form.classList.add("d-none");
    successMessage.classList.remove("d-none");
  });
</script>

<!-- Styles -->
<style>
  .text-gradient {
    background: linear-gradient(90deg, #007bff, #6610f2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .date-badge {
    background: #f8f9fa;
    border: 1px solid #e1e1e1;
    border-radius: 30px;
    padding: 8px 16px;
    font-size: 0.9rem;
    color: #6c757d;
    font-weight: 600;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  }

  .glass-effect {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.3);
  }

  .payment-option {
    transition: all 0.3s ease;
  }

  .btn-primary {
    background: linear-gradient(135deg, #007bff, #00bfff);
    border: none;
  }

  .btn-primary:hover {
    background: linear-gradient(135deg, #0069d9, #0099cc);
  }

  input.form-control {
    border-radius: 10px;
  }

  @media (max-width: 768px) {
    .card {
      padding: 1.5rem !important;
    }
  }
</style>
