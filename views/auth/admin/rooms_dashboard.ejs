<% title = "Room Status Dashboard" %>

<section class="container py-5 animate__animated animate__fadeIn">
  <!-- ===== Header ===== -->
  <div
    class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-5"
  >
    <div>
      <h2 class="fw-bold text-gradient mb-1">üè† Room Status Dashboard</h2>
      <p class="text-muted small mb-0">
        Monitor all hostel rooms, their occupancy, and batch-wise distribution.
      </p>
    </div>
    <div class="mt-3 mt-md-0">
      <a
        href="/admin/students"
        class="btn btn-gradient rounded-pill me-2 shadow-sm"
      >
        <i class="bi bi-arrow-left-circle me-1"></i> Back to Students
      </a>
      <button
        class="btn btn-outline-secondary rounded-pill shadow-sm"
        onclick="location.reload()"
      >
        <i class="bi bi-arrow-clockwise me-1"></i> Refresh
      </button>
    </div>
  </div>

  <!-- ===== Summary Cards ===== -->
  <div class="row g-4 mb-5 text-center">
    <div class="col-md-4">
      <div
        class="summary-card bg-gradient-success text-white p-4 rounded-4 shadow"
      >
        <h3 class="fw-bold mb-1">
          <%= rooms.filter(r => !r.isOccupied).length %>
        </h3>
        <p class="mb-0 small text-light">Vacant Rooms</p>
      </div>
    </div>
    <div class="col-md-4">
      <div
        class="summary-card bg-gradient-danger text-white p-4 rounded-4 shadow"
      >
        <h3 class="fw-bold mb-1">
          <%= rooms.filter(r => r.isOccupied).length %>
        </h3>
        <p class="mb-0 small text-light">Occupied Rooms</p>
      </div>
    </div>
    <div class="col-md-4">
      <div
        class="summary-card bg-gradient-primary text-white p-4 rounded-4 shadow"
      >
        <h3 class="fw-bold mb-1"><%= rooms.length %></h3>
        <p class="mb-0 small text-light">Total Rooms</p>
      </div>
    </div>
  </div>

  <!-- ===== Room Grid ===== -->
  <div class="row g-4">
    <% rooms.forEach(r => { %>
    <div class="col-lg-3 col-md-4 col-sm-6">
      <div
        class="room-card text-center shadow-sm p-3 rounded-4 position-relative overflow-hidden <%= r.isOccupied ? 'occupied' : 'vacant' %>"
      >
        <div class="room-header mb-2">
          <h5 class="fw-bold mb-1">Room <%= r.roomNumber %></h5>
          <p class="small text-muted mb-1">
            <i class="bi bi-gender-ambiguous me-1"></i><%= r.gender %> |
            <i class="bi bi-calendar3 me-1"></i><%= r.batchYear %>
          </p>
        </div>

        <div class="room-status mb-2">
          <span
            class="badge px-3 py-2 rounded-pill fw-semibold <%= r.isOccupied ? 'bg-danger' : 'bg-success' %>"
          >
            <%= r.isOccupied ? 'Occupied' : 'Vacant' %>
          </span>
        </div>

        <% if (r.occupants.length > 0) { %>
        <div class="occupants mt-2">
          <ul class="list-unstyled small mb-0">
            <% r.occupants.forEach(o => { %>
            <li class="text-dark">
              <i class="bi bi-person-circle text-primary me-1"></i>
              <%= o.name || "Student" %>
            </li>
            <% }) %>
          </ul>
        </div>
        <% } else { %>
        <p class="text-secondary small fst-italic mt-2">No occupant assigned</p>
        <% } %>
      </div>
    </div>
    <% }) %>
  </div>

  <!-- ===== Legend ===== -->
  <div class="mt-5 text-center small">
    <span class="badge bg-success me-2">Vacant</span>
    <span class="badge bg-danger me-2">Occupied</span>
    <span class="badge bg-secondary">Mixed/Partial</span>
  </div>
</section>

<!-- ===== Styles ===== -->
<style>
  body {
    background: linear-gradient(135deg, #f9fbff, #eef3f9);
    font-family: "Poppins", sans-serif;
  }
  .text-gradient {
    background: linear-gradient(90deg, #007bff, #6610f2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  /* --- Summary Cards --- */
  .summary-card {
    border-radius: 18px;
    transition: 0.3s ease;
  }
  .summary-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
  }
  .bg-gradient-success {
    background: linear-gradient(90deg, #28a745, #20c997);
  }
  .bg-gradient-danger {
    background: linear-gradient(90deg, #dc3545, #ff5c75);
  }
  .bg-gradient-primary {
    background: linear-gradient(90deg, #007bff, #6610f2);
  }

  /* --- Room Cards --- */
  .room-card {
    transition: all 0.35s ease;
    border: 2px solid transparent;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
  }
  .room-card:hover {
    transform: translateY(-5px) scale(1.02);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
  }
  .room-card.vacant {
    border-color: #28a745;
    background: rgba(40, 167, 69, 0.06);
  }
  .room-card.occupied {
    border-color: #dc3545;
    background: rgba(220, 53, 69, 0.07);
  }

  /* --- Badges --- */
  .badge {
    font-size: 0.8rem;
    letter-spacing: 0.3px;
    animation: pulse 2s infinite ease-in-out;
  }
  @keyframes pulse {
    0%,
    100% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(1.05);
      opacity: 0.85;
    }
  }

  /* --- Responsive --- */
  @media (max-width: 768px) {
    .room-card {
      padding: 1rem;
    }
    .summary-card h3 {
      font-size: 1.5rem;
    }
  }
</style>
