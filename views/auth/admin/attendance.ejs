<% title = "Attendance Tracker" %>

<section class="container-fluid py-5 px-md-4 animate__animated animate__fadeIn">
  <div class="d-flex justify-content-between align-items-center mb-5">
    <div>
      <h2 class="fw-bold gradient-text mb-1">ðŸ“… Hostel Attendance</h2>
      <p class="text-muted small mb-0">
        Monitor daily check-ins, late returns, and generate reports.
      </p>
    </div>
    <a href="/admin/attendance/export" class="btn btn-gradient rounded-pill">
      <i class="bi bi-download me-2"></i> Export to Excel
    </a>
  </div>

  <div class="glass-card p-4 shadow-glass">
    <form action="/admin/attendance/add" method="POST" class="row g-3 mb-4">
      <div class="col-md-3">
        <input
          type="text"
          name="studentId"
          placeholder="Student ID"
          class="form-control"
          required
        />
      </div>
      <div class="col-md-3">
        <input type="datetime-local" name="checkIn" class="form-control" />
      </div>
      <div class="col-md-3">
        <input type="datetime-local" name="checkOut" class="form-control" />
      </div>
      <div class="col-md-2">
        <select name="status" class="form-select">
          <option value="Present">Present</option>
          <option value="Late">Late</option>
          <option value="Absent">Absent</option>
        </select>
      </div>
      <div class="col-md-1 d-grid">
        <button class="btn btn-gradient">Add</button>
      </div>
    </form>

    <% if (records.length === 0) { %>
    <div class="text-center py-5">
      <i class="bi bi-person-x fs-1 text-muted"></i>
      <h5 class="fw-semibold mt-3">No Records Found</h5>
      <p class="text-secondary small">Attendance data will appear here.</p>
    </div>
    <% } else { %>
    <div class="table-responsive">
      <table class="table align-middle table-hover">
        <thead class="table-light">
          <tr>
            <th>Student Roll</th>
            <th>Hostel</th>
            <th>Date</th>
            <th>Check-In</th>
            <th>Check-Out</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <% records.forEach(r => { %>
          <tr>
            <td><%= r.student?.roll || "N/A" %></td>
            <td><%= r.student?.hostelName || "N/A" %></td>
            <td><%= new Date(r.date).toLocaleDateString() %></td>
            <td><%= r.checkIn ? new Date(r.checkIn).toLocaleTimeString() : "-" %></td>
            <td><%= r.checkOut ? new Date(r.checkOut).toLocaleTimeString() : "-" %></td>
            <td>
              <span class="badge 
                <%= r.status === 'Present' ? 'bg-success' : 
                    r.status === 'Late' ? 'bg-warning text-dark' : 
                    'bg-danger' %>">
                <%= r.status %>
              </span>
            </td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
    <% } %>
  </div>
</section>

<style>
  .gradient-text {
    background: linear-gradient(90deg, #007bff, #6610f2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  .btn-gradient {
    background: linear-gradient(90deg, #007bff, #00bfff);
    color: white;
    border: none;
  }
  .glass-card {
    background: rgba(255, 255, 255, 0.96);
    backdrop-filter: blur(10px);
    border-radius: 20px;
  }
</style>
